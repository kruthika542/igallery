{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive Image Gallery</title>
  <style>
    :root{
      --bg:#f0f0f0; --card:#fff; --accent:#0078d4; --overlay:rgba(0,0,0,.85);
    }
    body{font-family:Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);margin:0;padding:24px}
    h1{text-align:center;color:#222;margin:0 0 18px}
    .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;max-width:1100px;margin:0 auto}
    .card{background:var(--card);border-radius:10px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);display:block}
    .card img{display:block;width:100%;height:200px;object-fit:cover;cursor:pointer;transition:transform .25s ease}
    .card img:hover{transform:scale(1.03)}
    /* caption removed */
    /* modal / lightbox */
    .lightbox{display:none;position:fixed;inset:0;z-index:1200;align-items:center;justify-content:center;background:var(--overlay);padding:20px}
    .lightbox.open{display:flex}
    .lightbox-content{max-width:95%;max-height:90%;position:relative;display:flex;align-items:center;justify-content:center}
    .lightbox-content img{max-width:100%;max-height:100%;border-radius:8px;box-shadow:0 6px 30px rgba(0,0,0,.6)}
    .nav-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);color:#fff;padding:10px;border-radius:6px;cursor:pointer}
    .prev{left:16px} .next{right:16px}
    .close-btn{position:absolute;top:14px;right:16px;font-size:28px;color:#fff;background:transparent;border:none;cursor:pointer}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    @media (max-width:520px){ .card img{height:140px} .nav-btn{padding:8px} }
  </style>
</head>
<body>
  <h1>My Interactive Gallery</h1>

  <div class="gallery" id="gallery">
    <a class="card" data-index="0" href="#lightbox" aria-label="Open Image 1">
      <img loading="lazy" src="{% static 'gallery/images/img1.jpg' %}" alt="Sunset over hills" />
    </a>
    <a class="card" data-index="1" href="#lightbox" aria-label="Open Image 2">
      <img loading="lazy" src="{% static 'gallery/images/img2.jpg' %}" alt="Mountain lake" />
    </a>
    <a class="card" data-index="2" href="#lightbox" aria-label="Open Image 3">
      <img loading="lazy" src="{% static 'gallery/images/img3.jpg' %}" alt="Forest path" />
    </a>
    <a class="card" data-index="3" href="#lightbox" aria-label="Open Image 4">
      <img loading="lazy" src="{% static 'gallery/images/img4.jpg' %}" alt="City skyline" />
    </a>
    <a class="card" data-index="4" href="#lightbox" aria-label="Open Image 5">
      <img loading="lazy" src="{% static 'gallery/images/img5.jpg' %}" alt="Desert dunes" />
    </a>
    <a class="card" data-index="5" href="#lightbox" aria-label="Open Image 6">
      <img loading="lazy" src="{% static 'gallery/images/img6.jpg' %}" alt="Coastal cliffs" />
    </a>
    <a class="card" data-index="6" href="#lightbox" aria-label="Open Image 7">
      <img loading="lazy" src="{% static 'gallery/images/img7.jpg' %}" alt="Night stars" />
    </a>
  </div>

  <!-- Accessible Lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="lightbox-content" id="lightboxContent">
      <button class="nav-btn prev" id="prevBtn" aria-label="Previous image">&#10094;</button>
      <img id="lightboxImg" src="" alt="">
      <button class="nav-btn next" id="nextBtn" aria-label="Next image">&#10095;</button>
      <button class="close-btn" id="closeBtn" aria-label="Close">&times;</button>
    </div>
  </div>

  <script>
    // gallery image list (matches order above)
    const images = [
      "{% static 'gallery/images/img1.jpg' %}",
      "{% static 'gallery/images/img2.jpg' %}",
      "{% static 'gallery/images/img3.jpg' %}",
      "{% static 'gallery/images/img4.jpg' %}",
      "{% static 'gallery/images/img5.jpg' %}",
      "{% static 'gallery/images/img6.jpg' %}",
      "{% static 'gallery/images/img7.jpg' %}"
    ];
    const alts = [
      "Sunset over hills","Mountain lake","Forest path",
      "City skyline","Desert dunes","Coastal cliffs","Night stars"
    ];

    const gallery = document.getElementById('gallery');
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightboxImg');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeBtn = document.getElementById('closeBtn');
    let current = 0;

    function openLightbox(index){
      current = index;
      lightboxImg.src = images[current];
      lightboxImg.alt = alts[current];
      lightbox.classList.add('open');
      lightbox.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      closeBtn.focus();
    }
    function closeLightbox(){
      lightbox.classList.remove('open');
      lightbox.setAttribute('aria-hidden','true');
      lightboxImg.src = '';
      document.body.style.overflow = '';
    }
    function showNext(dir){
      current = (current + dir + images.length) % images.length;
      lightboxImg.src = images[current];
      lightboxImg.alt = alts[current];
    }

    // click on cards
    gallery.addEventListener('click', e => {
      const card = e.target.closest('.card');
      if(!card) return;
      e.preventDefault();
      const idx = Number(card.dataset.index);
      openLightbox(idx);
    });

    // lightbox controls
    prevBtn.addEventListener('click', ()=> showNext(-1));
    nextBtn.addEventListener('click', ()=> showNext(1));
    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e)=>{
      if(e.target === lightbox) closeLightbox();
    });

    // keyboard nav
    document.addEventListener('keydown', e=>{
      if(!lightbox.classList.contains('open')) return;
      if(e.key === 'Escape') closeLightbox();
      if(e.key === 'ArrowLeft') showNext(-1);
      if(e.key === 'ArrowRight') showNext(1);
    });

    // prefetch adjacent images for smoother nav
    function prefetch(idx){
      const i = new Image();
      i.src = images[(idx+1)%images.length];
      const j = new Image();
      j.src = images[(idx-1+images.length)%images.length];
    }
    const origShowNext = showNext;
    showNext = function(dir){
      origShowNext(dir);
      prefetch(current);
    }.bind(this);
  </script>
</body>
</html>